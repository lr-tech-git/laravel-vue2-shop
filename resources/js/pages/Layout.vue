<template>
    <div id="main">

        <loading v-if="$root.loading"></loading>

        <main style="width: 100%;" class="clearfix d-flex align-items-stretch" :class="{'open-menu':!close, 'active': mobAct}">
            <div class="d-block d-md-none position-absolute menu-mob-trigger">
                <button class="mobile-menu-trigger"  @click="menuShow($event)">
                    <svg  xmlns="http://www.w3.org/2000/svg" width="42" height="21" viewBox="0 0 42 21" fill="none">
                        <path d="M10.1694 20.6197C10.2678 20.7325 10.3898 20.8245 10.5275 20.8898C10.6653 20.9551 10.8157 20.9923 10.9693 20.9989C11.1229 21.0056 11.2762 20.9815 11.4195 20.9284C11.5628 20.8752 11.693 20.7941 11.8017 20.6902C11.9104 20.5862 11.9953 20.4618 12.0509 20.3248C12.1065 20.1878 12.1316 20.0412 12.1247 19.8944C12.1178 19.7476 12.0789 19.6038 12.0106 19.4721C11.9423 19.3405 11.846 19.2239 11.728 19.1298L3.776 11.5193L30.0602 11.5193C30.3439 11.5049 30.6111 11.387 30.8066 11.19C31.0021 10.9929 31.1111 10.7316 31.1111 10.46C31.1111 10.1884 31.0021 9.92711 30.8066 9.73002C30.6111 9.53294 30.3439 9.41506 30.0602 9.40067L3.776 9.40066L11.7404 1.79916C11.9409 1.59848 12.0527 1.33168 12.0527 1.05421C12.0527 0.776734 11.9409 0.509932 11.7404 0.309254C11.6382 0.211228 11.5167 0.133454 11.383 0.0803854C11.2493 0.0273172 11.1059 -1.74891e-06 10.9611 -1.76157e-06C10.8163 -1.77422e-06 10.673 0.0273172 10.5392 0.0803853C10.4055 0.133453 10.2841 0.211228 10.1818 0.309254L0.331508 9.72546C0.226668 9.82193 0.143268 9.93763 0.0863009 10.0656C0.0293341 10.1936 -2.57702e-05 10.3313 -2.57824e-05 10.4704C-2.57945e-05 10.6095 0.029334 10.7472 0.0863008 10.8752C0.143268 11.0032 0.226668 11.1189 0.331508 11.2154L10.1694 20.6197Z" fill="#FFB800"/>
                        <path d="M42 19.0714C42 19.604 41.5683 20.0357 41.0357 20.0357L16.9643 20.0357C16.4317 20.0357 16 19.604 16 19.0714C16 18.5389 16.4317 18.1071 16.9643 18.1071L41.0357 18.1071C41.5683 18.1071 42 18.5389 42 19.0714Z" fill="#F2F2F2"/>
                        <path d="M42 1.87505C42 2.49637 41.4963 3.00005 40.875 3.00005L26.7917 3.00004C26.1703 3.00004 25.6667 2.49636 25.6667 1.87504C25.6667 1.25372 26.1703 0.750045 26.7917 0.750045L40.875 0.750046C41.4963 0.750046 42 1.25373 42 1.87505Z" fill="#F2F2F2"/>
                    </svg>
                </button>
            </div>
            <div class="before d-mobile-hide" @click="close=!close"></div>
            <div class="before  d-mobile-show" @click="menuShow($event)"></div>
            <div v-if="$auth.check()" class="left-menu" :class="{'close-main-menu':close, 'active': mobAct}">
                <div class="row justify-content-end">
                    <div class="col-auto">
                        <button class="close-menu d-none d-md-block" @click="descShowMenu($event)">
                            <svg v-if="!close" xmlns="http://www.w3.org/2000/svg" width="42" height="21" viewBox="0 0 42 21" fill="none">
                                <path d="M10.1694 20.6197C10.2678 20.7325 10.3898 20.8245 10.5275 20.8898C10.6653 20.9551 10.8157 20.9923 10.9693 20.9989C11.1229 21.0056 11.2762 20.9815 11.4195 20.9284C11.5628 20.8752 11.693 20.7941 11.8017 20.6902C11.9104 20.5862 11.9953 20.4618 12.0509 20.3248C12.1065 20.1878 12.1316 20.0412 12.1247 19.8944C12.1178 19.7476 12.0789 19.6038 12.0106 19.4721C11.9423 19.3405 11.846 19.2239 11.728 19.1298L3.776 11.5193L30.0602 11.5193C30.3439 11.5049 30.6111 11.387 30.8066 11.19C31.0021 10.9929 31.1111 10.7316 31.1111 10.46C31.1111 10.1884 31.0021 9.92711 30.8066 9.73002C30.6111 9.53294 30.3439 9.41506 30.0602 9.40067L3.776 9.40066L11.7404 1.79916C11.9409 1.59848 12.0527 1.33168 12.0527 1.05421C12.0527 0.776734 11.9409 0.509932 11.7404 0.309254C11.6382 0.211228 11.5167 0.133454 11.383 0.0803854C11.2493 0.0273172 11.1059 -1.74891e-06 10.9611 -1.76157e-06C10.8163 -1.77422e-06 10.673 0.0273172 10.5392 0.0803853C10.4055 0.133453 10.2841 0.211228 10.1818 0.309254L0.331508 9.72546C0.226668 9.82193 0.143268 9.93763 0.0863009 10.0656C0.0293341 10.1936 -2.57702e-05 10.3313 -2.57824e-05 10.4704C-2.57945e-05 10.6095 0.029334 10.7472 0.0863008 10.8752C0.143268 11.0032 0.226668 11.1189 0.331508 11.2154L10.1694 20.6197Z" fill="#FFB800"/>
                                <path d="M42 19.0714C42 19.604 41.5683 20.0357 41.0357 20.0357L16.9643 20.0357C16.4317 20.0357 16 19.604 16 19.0714C16 18.5389 16.4317 18.1071 16.9643 18.1071L41.0357 18.1071C41.5683 18.1071 42 18.5389 42 19.0714Z" fill="#F2F2F2"/>
                                <path d="M42 1.87505C42 2.49637 41.4963 3.00005 40.875 3.00005L26.7917 3.00004C26.1703 3.00004 25.6667 2.49636 25.6667 1.87504C25.6667 1.25372 26.1703 0.750045 26.7917 0.750045L40.875 0.750046C41.4963 0.750046 42 1.25373 42 1.87505Z" fill="#F2F2F2"/>
                            </svg>
                            <svg v-else xmlns="http://www.w3.org/2000/svg" width="42" height="21" viewBox="0 0 42 21" fill="none">
                                <path d="M31.8306 0.380339C31.7322 0.267475 31.6102 0.17546 31.4725 0.110161C31.3347 0.0448622 31.1843 0.00771178 31.0307 0.00107827C30.8771 -0.00555525 30.7238 0.0184737 30.5805 0.0716332C30.4372 0.124793 30.307 0.205916 30.1983 0.309832C30.0896 0.413748 30.0047 0.538177 29.9491 0.675184C29.8935 0.812192 29.8684 0.958773 29.8753 1.10558C29.8822 1.25239 29.9211 1.39621 29.9894 1.52786C30.0577 1.65952 30.154 1.77612 30.272 1.87025L38.224 9.48069H11.9398C11.6561 9.49508 11.3889 9.61296 11.1934 9.81004C10.9979 10.0071 10.8889 10.2684 10.8889 10.54C10.8889 10.8116 10.9979 11.0729 11.1934 11.27C11.3889 11.4671 11.6561 11.5849 11.9398 11.5993H38.224L30.2596 19.2008C30.0591 19.4015 29.9473 19.6683 29.9473 19.9458C29.9473 20.2233 30.0591 20.4901 30.2596 20.6907C30.3618 20.7888 30.4833 20.8665 30.617 20.9196C30.7507 20.9727 30.8941 21 31.0389 21C31.1837 21 31.327 20.9727 31.4608 20.9196C31.5945 20.8665 31.7159 20.7888 31.8182 20.6907L41.6685 11.2745C41.7733 11.1781 41.8567 11.0624 41.9137 10.9344C41.9707 10.8064 42 10.6687 42 10.5296C42 10.3905 41.9707 10.2528 41.9137 10.1248C41.8567 9.9968 41.7733 9.8811 41.6685 9.78463L31.8306 0.380339Z" fill="#FFB800"/>
                                <path d="M0 1.92852C0 1.39596 0.431725 0.964233 0.964285 0.964233H25.0357C25.5683 0.964233 26 1.39596 26 1.92852C26 2.46108 25.5683 2.8928 25.0357 2.8928H0.964284C0.431724 2.8928 0 2.46108 0 1.92852Z" fill="#F2F2F2"/>
                                <path d="M0 19.125C0 18.5037 0.50368 18 1.125 18H15.2083C15.8297 18 16.3333 18.5037 16.3333 19.125C16.3333 19.7463 15.8297 20.25 15.2083 20.25H1.125C0.503679 20.25 0 19.7463 0 19.125Z" fill="#F2F2F2"/>
                            </svg>
                        </button>
                        <button class="close-menu d-block d-md-none" @click="menuShow($event)">
                            <svg  xmlns="http://www.w3.org/2000/svg" width="42" height="21" viewBox="0 0 42 21" fill="none">
                                <path d="M10.1694 20.6197C10.2678 20.7325 10.3898 20.8245 10.5275 20.8898C10.6653 20.9551 10.8157 20.9923 10.9693 20.9989C11.1229 21.0056 11.2762 20.9815 11.4195 20.9284C11.5628 20.8752 11.693 20.7941 11.8017 20.6902C11.9104 20.5862 11.9953 20.4618 12.0509 20.3248C12.1065 20.1878 12.1316 20.0412 12.1247 19.8944C12.1178 19.7476 12.0789 19.6038 12.0106 19.4721C11.9423 19.3405 11.846 19.2239 11.728 19.1298L3.776 11.5193L30.0602 11.5193C30.3439 11.5049 30.6111 11.387 30.8066 11.19C31.0021 10.9929 31.1111 10.7316 31.1111 10.46C31.1111 10.1884 31.0021 9.92711 30.8066 9.73002C30.6111 9.53294 30.3439 9.41506 30.0602 9.40067L3.776 9.40066L11.7404 1.79916C11.9409 1.59848 12.0527 1.33168 12.0527 1.05421C12.0527 0.776734 11.9409 0.509932 11.7404 0.309254C11.6382 0.211228 11.5167 0.133454 11.383 0.0803854C11.2493 0.0273172 11.1059 -1.74891e-06 10.9611 -1.76157e-06C10.8163 -1.77422e-06 10.673 0.0273172 10.5392 0.0803853C10.4055 0.133453 10.2841 0.211228 10.1818 0.309254L0.331508 9.72546C0.226668 9.82193 0.143268 9.93763 0.0863009 10.0656C0.0293341 10.1936 -2.57702e-05 10.3313 -2.57824e-05 10.4704C-2.57945e-05 10.6095 0.029334 10.7472 0.0863008 10.8752C0.143268 11.0032 0.226668 11.1189 0.331508 11.2154L10.1694 20.6197Z" fill="#FFB800"/>
                                <path d="M42 19.0714C42 19.604 41.5683 20.0357 41.0357 20.0357L16.9643 20.0357C16.4317 20.0357 16 19.604 16 19.0714C16 18.5389 16.4317 18.1071 16.9643 18.1071L41.0357 18.1071C41.5683 18.1071 42 18.5389 42 19.0714Z" fill="#F2F2F2"/>
                                <path d="M42 1.87505C42 2.49637 41.4963 3.00005 40.875 3.00005L26.7917 3.00004C26.1703 3.00004 25.6667 2.49636 25.6667 1.87504C25.6667 1.25372 26.1703 0.750045 26.7917 0.750045L40.875 0.750046C41.4963 0.750046 42 1.25373 42 1.87505Z" fill="#F2F2F2"/>
                            </svg>
                        </button>

                    </div>
                </div>

                <router-link  class="basket-link" :to="{ name : 'checkout' }">
                    <app-basket :basket-count="$store.state.productInCart"></app-basket>
                </router-link>

                <app-favorite v-if="getSettingValue('enabled_favorites_products') == 1" :favorite-count="$store.state.productInFavorite"></app-favorite>

                <left-nav-menu></left-nav-menu>
            </div>

            <content :class="{'main-menu-close':close}">
                <app-breadcrumbs container="nav" v-if="$router.currentRoute.meta.breadcrumb  &&
                    $router.currentRoute.meta.breadcrumb.hasOwnProperty('show') &&   $router.currentRoute.meta.breadcrumb.hasOwnProperty('show')">
                    <li slot-scope="{to, label, utils}" class="breadcrumb-item">
                        <router-link
                        :to="to"
                        exact
                        :itemprop="utils && utils.itemprop"
                        >{{translate(label)}}</router-link> <span class="slash"> / </span>
                    </li>

                    <span
                        slot="current"
                        slot-scope="{label}"
                        class="custom-current-class"
                    >{{translate(label)}}</span>
                </app-breadcrumbs>

                <router-view></router-view>
            </content>

        </main>
    </div>
</template>

<script>
import '@sass/global.scss';
import LeftNavMenu from '@component/LeftMenu.vue'

export default {
    components: {
        LeftNavMenu
    },
    data(){
      return {
          close: false,
          mobAct: false,
      }
    },
    mounted() {
        Vue.loadScript('http://localhost:8098');
        document.querySelector('body').addEventListener('click', el => {
            this.mobAct = false;

            if(document.querySelector('#main').clientWidth < 1366){
                this.close = true;
            }
        })
    },
    methods: {
        menuShow(e){
            e.stopPropagation();
            this.mobAct = !this.mobAct
        },
        descShowMenu(e){
            e.stopPropagation();
            this.close=!this.close;
        }
    }
}
</script>
